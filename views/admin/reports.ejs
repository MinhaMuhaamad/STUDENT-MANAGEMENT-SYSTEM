<%- include('../partials/header', { adminPage: true, user: { role: 'admin' } }) %>

<div class="reports-container">
  <h2>System Reports</h2>
  
  <div class="reports-tabs">
    <button class="tab-btn active" data-tab="course-students">Students by Course</button>
    <button class="tab-btn" data-tab="available-seats">Available Seats</button>
    <button class="tab-btn" data-tab="prerequisite-issues">Prerequisite Issues</button>
  </div>
  
  <div class="tab-content active" id="course-students-tab">
    <h3>Students Registered for a Course</h3>
    <div class="form-group">
      <label for="course-select">Select Course:</label>
      <select id="course-select">
        <option value="">-- Select a course --</option>
        <% courses.forEach(course => { %>
          <option value="<%= course._id %>"><%= course.courseCode %>: <%= course.title %></option>
        <% }); %>
      </select>
    </div>
    
    <div class="results-container">
      <table class="results-table" id="students-table">
        <thead>
          <tr>
            <th>Roll Number</th>
            <th>Name</th>
            <th>Email</th>
          </tr>
        </thead>
        <tbody id="students-table-body">
          <!-- Results will be loaded here -->
        </tbody>
      </table>
      <div id="no-students-message" class="no-results-message">
        Select a course to view registered students
      </div>
    </div>
  </div>
  
  <div class="tab-content" id="available-seats-tab">
    <h3>Courses with Available Seats</h3>
    <div class="results-container">
      <table class="results-table" id="available-courses-table">
        <thead>
          <tr>
            <th>Course Code</th>
            <th>Title</th>
            <th>Department</th>
            <th>Available Seats</th>
            <th>Total Seats</th>
          </tr>
        </thead>
        <tbody id="available-courses-table-body">
          <!-- Results will be loaded here -->
        </tbody>
      </table>
      <div id="no-available-courses-message" class="no-results-message">
        Loading courses...
      </div>
    </div>
  </div>
  
  <div class="tab-content" id="prerequisite-issues-tab">
    <h3>Students Missing Prerequisites</h3>
    <div class="results-container">
      <table class="results-table" id="prerequisite-issues-table">
        <thead>
          <tr>
            <th>Roll Number</th>
            <th>Student Name</th>
            <th>Course</th>
            <th>Missing Prerequisites</th>
          </tr>
        </thead>
        <tbody id="prerequisite-issues-table-body">
          <!-- Results will be loaded here -->
        </tbody>
      </table>
      <div id="no-prerequisite-issues-message" class="no-results-message">
        Loading prerequisite issues...
      </div>
    </div>
  </div>
</div>

<script src="/js/admin/reports.js"></script>

<%- include('../partials/footer') %>

